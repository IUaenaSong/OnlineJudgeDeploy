(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ad169fa6"],{"24b4":function(t,e,i){t.exports=i.p+"assets/img/default.fd8c1f48.jpg"},"5c3c":function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-card",[i("div",{staticClass:"section-title"},[t._v(t._s(t.$t("m.Avatar_Setting")))]),i("div",{staticClass:"section-main"},[i("avatar",{attrs:{inline:!0,size:130,color:"#FFF",src:t.group.avatar?t.group.avatar:t.defaultAvatar,shape:"square"}}),t.avatarOption.imgSrc?[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{xs:24,md:12}},[i("div",{staticClass:"cropper-main inline"},[i("vueCropper",{ref:"cropper",attrs:{autoCrop:"",fixed:"",autoCropWidth:200,autoCropHeight:200,img:t.avatarOption.imgSrc,outputSize:t.avatarOption.size,outputType:t.avatarOption.outputType,info:!0},on:{realTime:t.realTime}})],1),i("div",{staticClass:"cropper-btn"},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"向左旋转90°",trigger:"hover",placement:"bottom"}},[i("el-button",{attrs:{icon:"el-icon-refresh-left",size:"mini"},on:{click:function(e){return t.rotate("left")}}})],1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"向右旋转90°",trigger:"hover",placement:"bottom"}},[i("el-button",{attrs:{icon:"el-icon-refresh-right",size:"mini"},on:{click:function(e){return t.rotate("right")}}})],1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"关闭图像截取",trigger:"hover",placement:"bottom"}},[i("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:t.reselect}})],1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",trigger:"hover",content:"确定图像截取",placement:"bottom"}},[i("el-button",{attrs:{icon:"el-icon-check",size:"mini"},on:{click:t.finishCrop}})],1)],1)]),i("el-col",{attrs:{xs:24,md:12}},[i("div",{staticClass:"cropper-preview",style:t.previewStyle},[i("div",{style:t.preview.div},[i("img",{style:t.preview.img,attrs:{src:t.avatarOption.imgSrc}})])])])],1)]:[i("el-upload",{staticClass:"upload-container",attrs:{action:"",drag:"","before-upload":t.handleSelectFile}},[i("div",{staticStyle:{padding:"20px 0"}},[i("i",{staticClass:"el-icon-upload",staticStyle:{color:"#3399ff","font-size":"52px"}}),i("p",[t._v(t._s(t.$t("m.Upload_avatar_hint")))])])])],i("el-dialog",{attrs:{visible:t.uploadModalVisible,title:t.$t("m.Upload"),width:"350px"},on:{"update:visible":function(e){t.uploadModalVisible=e}}},[i("div",{staticClass:"upload-modal"},[i("p",{staticClass:"notice"},[t._v(t._s(t.$t("m.Your_new_avatar")+":"))]),i("img",{attrs:{src:t.uploadImgSrc}})]),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{loading:t.loadingUploadBtn,type:"primary"},on:{click:t.uploadAvatar}},[t._v(t._s(t.$t("m.Upload")))])],1)])],2),i("div",{staticClass:"section-title"},[t._v(t._s(t.$t("m.UserInfo_Setting")))]),i("el-form",{ref:"formGroup",attrs:{"label-position":"top",model:t.group,rules:t.rules}},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{md:12,xs:24}},[i("el-form-item",{attrs:{label:t.$t("m.Group_Name"),required:"",prop:"name"}},[i("el-input",{staticClass:"title-input",attrs:{placeholder:t.$t("m.Group_Name"),minlength:"5",maxlength:"25","show-word-limit":""},model:{value:t.group.name,callback:function(e){t.$set(t.group,"name",e)},expression:"group.name"}})],1)],1),i("el-col",{attrs:{md:12,xs:24}},[i("el-form-item",{attrs:{label:t.$t("m.Group_Short_Name"),required:"",prop:"shortName"}},[i("el-input",{staticClass:"title-input",attrs:{placeholder:t.$t("m.Group_Short_Name"),minlength:"5",maxlength:"10","show-word-limit":""},model:{value:t.group.shortName,callback:function(e){t.$set(t.group,"shortName",e)},expression:"group.shortName"}})],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:t.$t("m.Group_Brief"),required:"",prop:"brief"}},[i("el-input",{staticClass:"title-input",attrs:{placeholder:t.$t("m.Group_Brief"),minlength:"5",maxlength:"50","show-word-limit":""},model:{value:t.group.brief,callback:function(e){t.$set(t.group,"brief",e)},expression:"group.brief"}})],1)],1),i("el-col",{attrs:{md:8,xs:24}},[i("el-form-item",{attrs:{label:t.$t("m.Group_Auth"),required:"",prop:"auth"}},[i("el-select",{model:{value:t.group.auth,callback:function(e){t.$set(t.group,"auth",e)},expression:"group.auth"}},[i("el-tooltip",{attrs:{content:t.$t("m.Group_Public_Tips"),placement:"right"}},[i("el-option",{attrs:{label:t.$t("m.Group_Public"),value:1}})],1),i("el-tooltip",{attrs:{content:t.$t("m.Group_Protected_Tips"),placement:"right"}},[i("el-option",{attrs:{label:t.$t("m.Group_Protected"),value:2}})],1),i("el-tooltip",{attrs:{content:t.$t("m.Group_Private_Tips"),placement:"right"}},[i("el-option",{attrs:{label:t.$t("m.Group_Private"),value:3}})],1)],1)],1)],1),3==t.group.auth?i("el-col",{attrs:{md:8,xs:24}},[i("el-form-item",{attrs:{label:t.$t("m.Group_Code"),required:"",prop:"code"}},[i("el-input",{staticClass:"title-input",attrs:{placeholder:t.$t("m.Group_Code"),minlength:"6",maxlength:"6","show-word-limit":""},model:{value:t.group.code,callback:function(e){t.$set(t.group,"code",e)},expression:"group.code"}})],1)],1):t._e(),i("el-col",{attrs:{md:8,xs:24}},[i("el-form-item",{attrs:{label:t.$t("m.Visible"),required:"",prop:"visible"}},[i("el-switch",{attrs:{"active-text":t.$t("m.Group_Visible"),"inactive-text":t.$t("m.Group_Not_Visible")},model:{value:t.group.visible,callback:function(e){t.$set(t.group,"visible",e)},expression:"group.visible"}})],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:t.$t("m.Group_Description"),required:"",prop:"description"}},[i("Editor",{attrs:{value:t.group.description},on:{"update:value":function(e){return t.$set(t.group,"description",e)}}})],1)],1)],1)],1),i("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[i("el-button",{attrs:{type:"primary",loading:t.loadingSaveBtn},on:{click:t.updateGroup}},[t._v(t._s(t.$t("m.Save")))])],1)],1)},a=[],o=i("5530"),n=(i("d3b7"),i("3ca3"),i("ddb0"),i("ac1f"),i("00b4"),i("b0c0"),i("3228")),s=i("2f62"),l=i("90b9"),p=i("7e79"),u=i("4a89"),c=i.n(u),m=(i("e05f"),function(){return Promise.all([i.e("chunk-6593d29a"),i.e("chunk-13f2b59d")]).then(i.bind(null,"a956"))}),d={components:{Avatar:c.a,VueCropper:p["VueCropper"],Editor:m},data:function(){return{loadingSaveBtn:!1,loadingUploadBtn:!1,uploadModalVisible:!1,preview:{},uploadImgSrc:"",avatarOption:{imgSrc:"",size:.8,outputType:"png"},defaultAvatar:i("24b4"),rules:{name:[{required:!0,message:this.$i18n.t("m.Group_Name_Check_Required"),trigger:"blur"},{min:5,max:25,message:this.$i18n.t("m.Group_Name_Check_Min_Max"),trigger:"blur"}],shortName:[{required:!0,message:this.$i18n.t("m.Group_Short_Name_Check_Required"),trigger:"blur"},{min:5,max:10,message:this.$i18n.t("m.Group_Short_Name_Check_Min_Max"),trigger:"blur"}],brief:[{required:!0,message:this.$i18n.t("m.Group_Brief_Check_Required"),trigger:"blur"},{min:5,max:50,message:this.$i18n.t("m.Group_Brief_Check_Min_Max"),trigger:"blur"}],code:[{required:!0,message:this.$i18n.t("m.Group_Code_Check_Required"),trigger:"blur"},{min:6,max:6,message:this.$i18n.t("m.Group_Code_Check_Min_Max"),trigger:"blur"}],auth:[{required:!0,message:this.$i18n.t("m.Group_Auth_Check_Required"),trigger:"blur"}],description:[{required:!0,message:this.$i18n.t("m.Group_Description_Check_Required"),trigger:"blur"},{min:5,max:1e3,message:this.$i18n.t("m.Group_Description_Check_Min_Max"),trigger:"blur"}]}}},methods:Object(o["a"])(Object(o["a"])({},Object(s["b"])(["changeDomTitle"])),{},{checkFileType:function(t){return!!/\.(gif|jpg|jpeg|png|bmp|webp|GIF|JPG|PNG|WEBP)$/.test(t.name)||(this.$notify.warning({title:this.$i18n.t("m.File_type_not_support"),message:t.name+this.$i18n.t("m.is_incorrect_format_file")}),!1)},checkFileSize:function(t){return!(t.size>2097152)||(this.$notify.warning({title:this.$i18n.t("m.Exceed_max_size_limit"),message:t.name+this.$i18n.t("m.File_Exceed_Tips")}),!1)},handleSelectFile:function(t){var e=this,i=this.checkFileType(t)&&this.checkFileSize(t);if(!i)return!1;var r=new window.FileReader;return r.onload=function(t){e.avatarOption.imgSrc=t.target.result},r.readAsDataURL(t),!1},realTime:function(t){this.preview=t},rotate:function(t){"left"===t?this.$refs.cropper.rotateLeft():this.$refs.cropper.rotateRight()},reselect:function(){var t=this;this.$confirm(this.$i18n.t("m.Cancel_Avater_Tips"),"Tips",{confirmButtonText:this.$i18n.t("m.OK"),cancelButtonText:this.$i18n.t("m.Cancel"),type:"warning"}).then((function(){t.avatarOption.imgSrc=""}))},finishCrop:function(){var t=this;this.$refs.cropper.getCropData((function(e){t.uploadImgSrc=e,t.uploadModalVisible=!0}))},uploadAvatar:function(){var t=this;this.$refs.cropper.getCropBlob((function(e){var i=new window.FormData,r=new window.File([e],"avatar."+t.avatarOption.outputType);i.append("image",r),i.append("gid",t.$route.params.groupID),t.loadingUploadBtn=!0,t.$http({method:"post",url:"/api/file/upload-group-avatar",data:i,headers:{"content-type":"multipart/form-data"}}).then((function(e){t.loadingUploadBtn=!1,t.$msg.success(t.$i18n.t("m.Upload_Avatar_Successfully")),t.uploadModalVisible=!1,t.avatarOption.imgSrc="",t.$store.dispatch("setGroup",e.data.data)}),(function(){t.loadingUploadBtn=!1}))}))},updateGroup:function(){var t=this;this.$refs["formGroup"].validate((function(e){if(e){t.loadingSaveBtn=!0;var i=l["a"].filterEmptyValue(Object.assign({},t.group));n["a"].updateGroup(i).then((function(e){t.$msg.success(t.$i18n.t("m.Update_Successfully")),t.$store.dispatch("getGroup").then((function(e){t.changeDomTitle({title:e.data.data.name})})),t.loadingSaveBtn=!1}),(function(e){t.loadingSaveBtn=!1}))}}))}}),computed:Object(o["a"])(Object(o["a"])({},Object(s["d"])({group:function(t){return t.group.group}})),{},{avatar:function(){return this.$store.getters.group.avatar},previewStyle:function(){return{width:this.preview.w+"px",height:this.preview.h+"px",overflow:"hidden"}}})},g=d,h=(i("5ca6"),i("2877")),f=Object(h["a"])(g,r,a,!1,null,"2fa15405",null);e["default"]=f.exports},"5ca6":function(t,e,i){"use strict";i("795e")},"795e":function(t,e,i){},e05f:function(t,e,i){}}]);