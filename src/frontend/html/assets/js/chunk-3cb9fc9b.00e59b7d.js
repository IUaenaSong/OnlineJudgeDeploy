(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3cb9fc9b","chunk-13f2b59d"],{"034c":function(t,n,e){},"0437":function(t,n,e){},"7e81":function(t,n,e){},"82d0":function(t,n,e){"use strict";e.r(n);var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("el-card",[e("div",{staticClass:"filter-row"},[e("el-row",[e("el-col",{attrs:{span:3}},[e("span",{staticClass:"title"},[t._v(t._s(t.$t("m.Group_Announcement")))])]),e("el-col",{attrs:{span:18}},[e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.handleCreatePage}},[t._v(t._s(t.$t("m.Create")))])],1)],1)],1),e("AnnouncementList",{ref:"announcementList"})],1)},o=[],a=e("d696"),u={name:"GroupAnnouncementList",components:{AnnouncementList:a["a"]},data:function(){return{}},mounted:function(){this.init()},methods:{init:function(){},handleCreatePage:function(){this.$refs.announcementList.openAnnouncementDialog(null)}},computed:{}},s=u,l=(e("b861"),e("2877")),c=Object(l["a"])(s,i,o,!1,null,"c0b77154",null);n["default"]=c.exports},"857a":function(t,n,e){var i=e("e330"),o=e("1d80"),a=e("577e"),u=/"/g,s=i("".replace);t.exports=function(t,n,e,i){var l=a(o(t)),c="<"+n;return""!==e&&(c+=" "+e+'="'+s(a(i),u,"&quot;")+'"'),c+">"+l+"</"+n+">"}},"92bc":function(t,n,e){"use strict";e("7e81")},9911:function(t,n,e){"use strict";var i=e("23e7"),o=e("857a"),a=e("af03");i({target:"String",proto:!0,forced:a("link")},{link:function(t){return o(this,"a","href",t)}})},a956:function(t,n,e){"use strict";e.r(n);var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("mavon-editor",{ref:"md",style:0!=t.height?"min-height:"+t.height+"px":"",attrs:{ishljs:!0,html:t.openHtml,autofocus:!1,toolbars:t.toolbars,codeStyle:"arduino-light",toolbarsFlag:t.toolbarsFlag},on:{imgAdd:t.$imgAdd,imgDel:t.$imgDel},scopedSlots:t._u([t.isAdminRole?{key:"left-toolbar-after",fn:function(){return[e("button",{staticClass:"op-icon fa markdown-upload",attrs:{type:"button",title:t.$t("m.Upload_file"),"aria-hidden":"true"},on:{click:t.uploadFile}},[e("i",{staticClass:"el-icon-upload"})])]},proxy:!0}:null],null,!0),model:{value:t.currentValue,callback:function(n){t.currentValue=n},expression:"currentValue"}}),e("input",{ref:"uploadInput",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:t.uploadFileChange}})],1)},o=[],a=e("5530"),u=(e("a9e3"),e("9911"),e("99af"),e("b0c0"),e("2f62")),s=e("b355"),l={name:"Editor",props:{value:{type:String,default:""},openHtml:{type:Boolean,default:!0},toolbarsFlag:{type:Boolean,default:!0},height:{type:Number,default:0}},data:function(){return{currentValue:this.value,img_file:{},toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!1,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!0,help:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0}}},created:function(){(this.isAdminRole||this.isGroupAdmin||this.$route.params.examID)&&(this.toolbars.imagelink=!0)},methods:{$imgAdd:function(t,n){var e=this;if(this.isAdminRole||this.isGroupAdmin||this.$route.params.examID){var i=new FormData;i.append("image",n),this.$route.params.groupID&&i.append("gid",this.$route.params.groupID),this.$route.params.examID&&i.append("eid",this.$route.params.examID),this.$http({url:"/api/file/upload-md-img",method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}}).then((function(n){e.$refs.md.$img2Url(t,n.data.data.link),e.img_file[n.data.data.link]=n.data.data.fileId}))}},$imgDel:function(t){this.$http({url:"/api/file/delete-md-img",method:"get",params:{fileId:this.img_file[t[0]]}})},uploadFile:function(){this.$refs.uploadInput.click()},uploadFileChange:function(t){var n=this,e=t.target.files[0],i=new FormData;i.append("file",e),this.$route.params.groupID&&i.append("gid",this.$route.params.groupID),this.$route.params.examID&&i.append("eid",this.$route.params.examID),this.$http({url:"/api/file/upload-md-file",method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}}).then((function(t){var i=n.$refs.md;i.insertText(i.getTextareaDom(),{prefix:"[".concat(e.name,"](").concat(t.data.data.link,")"),subfix:"",str:""})}))}},computed:Object(a["a"])({},Object(u["c"])(["isAdminRole","isGroupAdmin"])),watch:{value:function(t){this.currentValue!==t&&(this.currentValue=t)},currentValue:function(t,n){t!==n&&(this.$emit("update:value",t),this.$nextTick((function(t){Object(s["a"])()})))},isAdminRole:function(t){this.toolbars.imagelink=!!t}}},c=l,r=(e("92bc"),e("2877")),d=Object(r["a"])(c,i,o,!1,null,null,null);n["default"]=d.exports},af03:function(t,n,e){var i=e("d039");t.exports=function(t){return i((function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}))}},b861:function(t,n,e){"use strict";e("0437")},cd34:function(t,n,e){"use strict";e("034c")},d696:function(t,n,e){"use strict";var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("vxe-table",{attrs:{stripe:"","auto-resize":"",data:t.adminAnnouncementList,loading:t.loading,align:"center"}},[e("vxe-table-column",{attrs:{"min-width":"50",field:"id",title:"ID"}}),e("vxe-table-column",{attrs:{"min-width":"150",field:"title","show-overflow":"",title:t.$t("m.Announcement_Title")}}),e("vxe-table-column",{attrs:{"min-width":"150",field:"gmtCreate",title:t.$t("m.Created_Time")},scopedSlots:t._u([{key:"default",fn:function(n){var e=n.row;return[t._v(" "+t._s(t._f("localtime")(e.gmtCreate))+" ")]}}])}),e("vxe-table-column",{attrs:{"min-width":"150",field:"gmtModified",title:t.$t("m.Modified_Time")},scopedSlots:t._u([{key:"default",fn:function(n){var e=n.row;return[t._v(" "+t._s(t._f("localtime")(e.gmtModified))+" ")]}}])}),e("vxe-table-column",{attrs:{"min-width":"150",field:"username","show-overflow":"",title:t.$t("m.Author")}}),e("vxe-table-column",{attrs:{"min-width":"100",field:"status",title:t.$t("m.Announcement_visible")},scopedSlots:t._u([{key:"default",fn:function(n){var i=n.row;return[e("el-switch",{attrs:{"active-text":"","inactive-text":"","active-value":0,"inactive-value":1,disabled:!t.isGroupRoot&&i.uid!=t.userInfo.uid},on:{change:function(n){return t.handleVisibleSwitch(i)}},model:{value:i.status,callback:function(n){t.$set(i,"status",n)},expression:"row.status"}})]}}])}),e("vxe-table-column",{attrs:{title:t.$t("m.Option"),"min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(n){var i=n.row;return[t.isGroupRoot||i.uid==t.userInfo.uid?e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("m.Edit_Announcement"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-edit-outline",size:"mini",type:"primary"},nativeOn:{click:function(n){return t.openAnnouncementDialog(i)}}})],1):t._e(),t.isGroupRoot||i.uid==t.userInfo.uid?e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("m.Delete_Announcement"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-delete-solid",size:"mini",type:"danger"},nativeOn:{click:function(n){return t.deleteAnnouncement(i.id)}}})],1):t._e()]}}])})],1),e("Pagination",{attrs:{total:t.adminTotal,"page-size":t.limit,current:t.currentPage,layout:"prev, pager, next, sizes"},on:{"on-change":t.currentChange,"update:current":function(n){t.currentPage=n},"on-page-size-change":t.onPageSizeChange}}),e("el-dialog",{staticStyle:{"text-align":"left"},attrs:{title:t.announcementDialogTitle,visible:t.showEditAnnouncementDialog,fullscreen:!0},on:{"update:visible":function(n){t.showEditAnnouncementDialog=n},open:t.onOpenEditDialog}},[e("el-form",{attrs:{"label-position":"top",model:t.announcement}},[e("el-form-item",{attrs:{label:t.$t("m.Announcement_Title"),required:""}},[e("el-input",{staticClass:"title-input",attrs:{placeholder:t.$t("m.Announcement_Title")},model:{value:t.announcement.title,callback:function(n){t.$set(t.announcement,"title",n)},expression:"announcement.title"}})],1),e("el-form-item",{attrs:{label:t.$t("m.Announcement_Content"),required:""}},[e("Editor",{attrs:{value:t.announcement.content},on:{"update:value":function(n){return t.$set(t.announcement,"content",n)}}})],1),e("div",{staticClass:"visible-box"},[e("span",[t._v(t._s(t.$t("m.Announcement_visible")))]),e("el-switch",{attrs:{"active-value":0,"inactive-value":1,"active-text":"","inactive-text":""},model:{value:t.announcement.status,callback:function(n){t.$set(t.announcement,"status",n)},expression:"announcement.status"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"danger"},nativeOn:{click:function(n){t.showEditAnnouncementDialog=!1}}},[t._v(t._s(t.$t("m.Cancel")))]),e("el-button",{attrs:{type:"primary"},nativeOn:{click:function(n){return t.submitAnnouncement.apply(null,arguments)}}},[t._v(t._s(t.$t("m.OK")))])],1)],1)],1)},o=[],a=e("5530"),u=(e("d3b7"),e("3ca3"),e("ddb0"),e("a9e3"),e("2f62")),s=e("3228"),l=e("a956"),c=function(){return e.e("chunk-48bf8d0f").then(e.bind(null,"5072"))},r={name:"GroupAnnouncementList",components:{Pagination:c,Editor:l["default"],AnnouncementList:p},props:{contestID:{type:Number,default:null}},data:function(){return{showEditAnnouncementDialog:!1,adminTotal:0,currentPage:1,limit:10,mode:"create",adminAnnouncementList:[],announcement:{id:null,title:"",content:"",status:0,uid:""},announcementDialogTitle:"Edit Announcement",loading:!1,routeName:""}},mounted:function(){this.init()},methods:{init:function(){this.contestID?this.getGroupContestAnnouncementList():this.getGroupAdminAnnouncementList()},onPageSizeChange:function(t){this.limit=t,this.init()},currentChange:function(t){this.currentPage=t,this.init()},getGroupAdminAnnouncementList:function(){var t=this;this.loading=!0,s["a"].getGroupAdminAnnouncementList(this.currentPage,this.limit,this.$route.params.groupID).then((function(n){t.adminAnnouncementList=n.data.data.records,t.adminTotal=n.data.data.total,t.loading=!1}),(function(n){t.loading=!1}))},getGroupContestAnnouncementList:function(){var t=this;this.loading=!0,s["a"].getGroupContestAnnouncementList(this.currentPage,this.limit,this.contestID).then((function(n){t.adminAnnouncementList=n.data.data.records,t.adminTotal=n.data.data.total,t.loading=!1}),(function(n){t.loading=!1}))},onOpenEditDialog:function(){setTimeout((function(){if(document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("resize",!0,!0),window.dispatchEvent(t)}else document.createEventObject&&window.fireEvent("onresize")}),0)},submitAnnouncement:function(){var t,n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,i="";if(e.id||(e=this.announcement),e.gid=this.$route.params.groupID,this.contestID){var o={announcement:e,cid:this.contestID};t=o,i="edit"===this.mode?"updateGroupContestAnnouncement":"addGroupContestAnnouncement"}else i="edit"===this.mode?"updateGroupAnnouncement":"addGroupAnnouncement",t=e;s["a"][i](t).then((function(t){n.showEditAnnouncementDialog=!1,n.$msg.success(n.$i18n.t("m.Post_successfully")),n.currentChange(1)})).catch()},deleteAnnouncement:function(t){var n=this;this.$confirm(this.$i18n.t("m.Delete_Announcement_Tips"),this.$i18n.t("m.Warning"),{confirmButtonText:this.$i18n.t("m.OK"),cancelButtonText:this.$i18n.t("m.Cancel"),type:"warning"}).then((function(){n.loading=!0,n.contestID?s["a"].deleteGroupContestAnnouncement(t,n.contestID).then((function(t){n.loading=!0,n.$msg.success(n.$i18n.t("m.Delete_successfully")),n.init()})):s["a"].deleteGroupAnnouncement(t).then((function(t){n.loading=!0,n.$msg.success(n.$i18n.t("m.Delete_successfully")),n.init()}))})).catch((function(){n.loading=!1}))},openAnnouncementDialog:function(t){this.showEditAnnouncementDialog=!0,null!==t?(this.announcementDialogTitle=this.$i18n.t("m.Edit_Announcement"),this.announcement=Object.assign({},t),this.mode="edit"):(this.announcementDialogTitle=this.$i18n.t("m.Create_Announcement"),this.announcement.title="",this.announcement.status=0,this.announcement.content="",this.announcement.uid=this.userInfo.uid,this.announcement.username=this.userInfo.username,this.mode="add")},handleVisibleSwitch:function(t){this.mode="edit",this.submitAnnouncement({id:t.id,title:t.title,content:t.content,status:t.status,uid:t.uid})}},computed:Object(a["a"])({},Object(u["c"])(["userInfo","isGroupRoot"]))},d=r,m=(e("cd34"),e("2877")),f=Object(m["a"])(d,i,o,!1,null,"21d28bc6",null),p=n["a"]=f.exports}}]);